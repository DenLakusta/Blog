{% extends 'hanabis_blog/base.html' %}
{% load post_tags %}


{% block firs_posts %}

    {% get_last_posts count=4 %}

<div class="col-lg-3">
  <div class="row">
    <div class="col-12">
      <div class="section-title">
        <h2>Hot News</h2>
      </div>
    </div>
    <div class="col-md-8">
      <div class="post-entry-1">
        <a href="{{ post_list.0.get_absolute_url }}"><img src="{{ post_list.all.0.image.url }}" alt="Image" class="img-fluid"></a>
        <h2><a href="{{ post_list.all.0.get_absolute_url }}">{{ post_list.0.title }}</a></h2>
        <p>{{ post_list.all.0.body|striptags|slice:':100' }}</p>
        <div class="post-meta">
          <span class="d-block">
          {% for auth in  post_list.0.auth.all %}
            <a href="{{ auth.get_absolute_url }}">{{ auth }}</a> in
          {% endfor %}
            <a href="{{ post_list.0.category.get_absolute_url }}">{{ post_list.0.category }}</a>
          </span>
          <span class="d-block">Tags:&nbsp;
           {% for tag in post_list.0.tags.all %}
              <a href="{{ tag.get_absolute_url }}">{{ tag }}</a>
           {% endfor %}
          </span>
          <span class="date-read">{{ post_list.0.date_pub }}<span class="mx-1">&bullet;
          </span> 3 min read <span class="icon-star2"></span></span>
        </div>
      </div>
    </div>
  </div>
  </div>

{% endblock firs_posts %}

{% block posts %}
  <div class="row">
    <div class="col-lg-8">
      <div class="section-title">
        <h2 id="posts">Recent posts</h2>
      </div>
      {% for post in post_list %}
      <div class="post-entry-2 d-flex">
        <div class="thumbnail order-md-2" style="background-image: url('{{ post.image.url }}')"></div>
          <div class="contents order-md-1 pl-0">
            <h2><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h2>
            <p class="mb-3">{{ post.body|striptags|slice:':100' }}</p>
              <div class="post-meta">
                 <span class="d-block">
                 {% for auth in  post.auth.all %}
                   <a href="{{ aut.get_absolute_url  }}">{{ auth }}</a>
                 {% endfor %}
                 in
    {#            {% for category in post.category %}#}
                 <a href="{{ post.get_absolute_url }}">{{ post.category }}</a></span>
    {#            {% endfor %}#}

                 <span class="d-block">Tags:&nbsp;
                   {% for tag in post.tags.all %}
                       <a href="{{ tag.get_absolute_url }}">{{ tag }}</a>
                   {% endfor %}
                 </span>
                <span class="date-read">{{ post.date_pub }}<span class="mx-1">&bullet;</span> 3 min read <span class="icon-star2"></span></span>
              </div>
          </div>
      </div>
      {% endfor %}
    </div>
    <div class="row">
        <div class="col-lg-6">

                <ul class="custom-pagination list-unstyled">

                    {% if page_obj.has_previous %}
                        {% if page_obj.number|add:-3 > 1 %}
                            <li><a href="?{{ s }}page=1#posts">1</a></li>
                        {% endif %}
                        {% if page_obj.number|add:-3 > 3 %}
                            <li><a href="?{{ s }}page={{ page_obj.previous_page_number|add:-3 }}#posts">
                                <span class="dots">...</span>
                            </a></li>
                        {% endif %}
                            <li><a class="pgn__prev"  href="?{{ s }}page={{ page_obj.previous_page_number }}#posts">Prev</a></li>
                         {% endif %}

                    {%  if paginator.page_range|length > 1 %}
                        {% for page_num in paginator.page_range %}
                             {% if page_obj.number == page_num %}
                                <li><a class="active" href="?{{ s }}page={{ page_num }}#posts">{{ page_num }}</a></li>
                            {% elif page_num > page_obj.number|add:-4  and page_num < page_obj.number|add:4 %}
                                  <li><a href="?{{ s }}page={{ page_num }}#posts">{{ page_num }}</a></li>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
{#                            <li><span class="pgn__num current">#}
{#                                 Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.#}
{#                           </span></li>#}

{#                    <li><a class="pgn__num" href="?page={{ page_obj.paginator.num_pages }}">{{ page_obj.paginator.num_pages }}</a></li>#}
                    {% if page_obj.has_next %}
                        {% if page_obj.number|add:4 < page_obj.paginator.num_pages %}
                            <li><a href="?{{ s }}page={{ page_obj.next_page_number|add:3 }}#posts">
                                <span class="dots">...</span>
                            </a></li>
                        {% endif %}
                        {% if page_obj.number|add:3 < page_obj.paginator.num_pages %}
                            <li><a href="?{{ s }}page={{ page_obj.paginator.num_pages }}#posts">{{ page_obj.paginator.num_pages }}</a></li>

                        {% endif %}
                        <li><a class="pgn__next" href="?{{ s }}page={{ page_obj.next_page_number }}#posts">Next</a></li>
                    {% endif %}
                </ul>

        </div>
    </div>
  </div>
{% include 'hanabis_blog/pagination.html' %}
{% endblock posts %}



